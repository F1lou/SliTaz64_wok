# SliTaz package receipt.

PACKAGE="sway"
VERSION="1.7"
CATEGORY="x-window"
SHORT_DESC="i3-compatible Wayland compositor"
MAINTAINER="nhc1@gmx.net"
LICENSE="MIT"
WEB_SITE="https://swaywm.org/"
TARBALL="$PACKAGE-$VERSION.tar.gz"
WGET_URL="https://github.com/swaywm/sway/archive/refs/tags/$VERSION.tar.gz"

DEPENDS="wayland mesa-wayland libevdev pcre2 libjson-c pango-wayland
	cairo-wayland gtk+3-wayland libxkbcommon-wayland libdrm-wayland 
	wlroots libseat" # gdk-pixbuf
BUILD_DEPENDS="wayland-dev wayland-protocols pcre2 libjson-c-dev
	git wlroots-dev libxkbcommon-wayland-dev libgio-dev libevdev-dev
	mesa-wayland-dev cairo-wayland-dev pango-wayland-dev
	wlroots-dev libdrm-wayland-dev libseat-dev" # gdk-pixbuf-dev

# Rules to configure and make the package.
compile_rules()
{
	export CFLAGS="$CFLAGS -Wno-error=address"
	meson --prefix=/usr build &&
	ninja -C build &&
	ninja -C build install
}

# Rules to gen a SliTaz package suitable for Tazpkg.

genpkg_rules()
{
	cp -a $install/* $fs
	chmod a+s $fs/usr/bin/sway
}
